data = rbind(data,dayData)
}
}
write.csv(data, paste(path,"output.csv", sep = ""), row.names = F)
unique(data$location)
View(data)
path = "c:/models/flickr/byUser/"
library(dplyr)
data = data.frame()
for (fileIndex in 1:563){
fileName = paste(path, fileIndex,".csv", sep = "")
if (file.exists(fileName)) {
userData = read.csv(fileName,fileEncoding = "UTF-8")
data = rbind(data,userData)
}
}
data = data %>%
filter(time != -1)
write.csv(data, paste(path,"outputByUser.csv", sep = ""), row.names = F)
library(dplyr)
path = "c:/models/flickr/byDay/"
data = data.frame()
for (fileIndex in 1:563){
fileName = paste(path, fileIndex,".csv", sep = "")
if (file.exists(fileName)) {
dayData = read.csv(fileName,fileEncoding = "UTF-8")
dayData = dayData[!duplicated(dayData),]
data = rbind(data,dayData)
}
}
#remove duplicates
write.csv(data, paste(path,"output.csv", sep = ""), row.names = F)
#analyze users origin
listOfLocations = data.frame(location = as.character(unique(data$location)))
listOfLocations$hasnich = grepl("nich", listOfLocations$location)
listOfLocations$hasnchen = grepl("nchen", listOfLocations$location)
listOfLocations$hasyern = grepl("yern", listOfLocations$location)
listOfLocations$visitor = if_else(listOfLocations$hasnich | listOfLocations$hasnchen | listOfLocations$hasyern, "resident", "visitor")
listOfLocations$visitor[listOfLocations$location==""] = "unknown"
listOfLocations = listOfLocations %>% select(location = location, type = visitor)
listOfLocations %>% group_by(type) %>% summarise(n = n())
simplePictureList = data %>% select(id, personId, time, lon, lat)
userType = merge(x=data, y=listOfLocations, by= "location") %>% select(personId,type)
path = "c:/models/flickr/byUser/"
library(dplyr)
dataUsers = data.frame()
for (fileIndex in 1:908){
fileName = paste(path, fileIndex,".csv", sep = "")
if (file.exists(fileName)) {
userData = read.csv(fileName,fileEncoding = "UTF-8")
dataUsers = rbind(dataUsers,userData)
}
}
dataUsers = dataUsers %>%
filter(time != -1)
usersAndType = data %>% select(personId, type)
write.csv(dataUsers, paste(path,"outputByUser.csv", sep = ""), row.names = F)
simplePictureList2 = dataUsers %>% select(id, personId, time, lon, lat)
simplePictureList = rbind(simplePictureList, simplePictureList2)
simplePictureList = simplePictureList[!duplicated(simplePictureList),]
simplePictureList$personId = as.character(simplePictureList$personId)
userType$personId = as.character(userType$personId)
userType = userType[!duplicate(userType),]
userType = userType[!duplicated(userType),]
simplePictureList = merge(x=simplePictureList, y=userType, by = "personId")
path = "c:/models/flickr/"
write.csv(simplePictureList, paste(path,"all.csv", sep = ""), row.names = F)
raw = read.csv(paste(path,file,sep=""))
path = "c:/models/flickr/"
file = "allPicsWithLandkreis.csv"
raw = read.csv(paste(path,file,sep=""))
View(raw)
pacman::p_load(dplyr, data.table, ggplot2)
View(raw)
data = raw %>% select(personId, id, time, lon, lat, type, FA, FA_NR, GEN, AGS)
View(data)
data = data %>% rowwise() %>% mutate(lkr_id = if_else(is.na(FA_NR),AGS,FA_NR))
data = data %>% rowwise() %>% mutate(lkr_name = if_else(is.na(FA),GEN,FA))
View(data)
data = data %>% rowwise() %>% mutate(lkr_name = if_else(FA=="",GEN,FA))
data = data %>% rowwise() %>% mutate(lkr_name = if_else(as.character(FA)=="",as.character(GEN),as.character(FA)))
data = data %>% select(personId, id, time, lon, lat, type, lkr_id, lkr_name)
View(data)
users_muc = data %>% filter(lkr_id == 9162000)
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId)
users_muc = (data %>% filter(lkr_id == 9162000) %>% select(personId))$personId
users_muc = unique(data %>% filter(lkr_id == 9162000) %>% select(personId))$personId
data_users_muc_other = filter(personId %in% users_muc, lkr_id != 9162000)
data_users_muc_at_other = data %>% filter(personId %in% users_muc, lkr_id != 9162000)
data_users_muc_at_other %>% group_by(lkr_name) %>% summary(n = n())
data_users_muc_at_other %>% group_by(lkr_name) %>% summarize(n = n())
data_users_muc_at_other %>% group_by(lkr_name, type) %>% summarize(n = n())
summary_pics = data_users_muc_at_other %>% group_by(lkr_name, type) %>% summarize(n = n())
ggplot(summay_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity")
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity")
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge")
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
summary_pics = data_users_muc_at_other %>%
group_by(lkr_name, type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
users_muc_at_other = data_users_muc_at_other %>% group_by(personId, lkr_name, type) %>% summarize(pictures = n())
summary_users = users_muc_at_other %>%
group_by(lkr_name, type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
ggplot(summary_users, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
visitors_muc = unique(data %>% filter(lkr_id == 9162000, type = "visitor") %>% select(personId))$personId
visitors_muc = unique(data %>% filter(lkr_id == 9162000, type == "visitor") %>% select(personId))$personId
visitors_muc = as.character(unique(data %>%
filter(lkr_id == 9162000, type == "visitor") %>%
select(personId))$personId)
visitors_muc = length(as.character(unique(data %>%
filter(lkr_id == 9162000, type == "visitor") %>%
select(personId))$personId))
summary_users = users_muc_at_other %>%
group_by(lkr_name, type) %>%
summarize(n = n()/visitors_muc) %>%
filter(type == "visitor")
ggplot(summary_users, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
View(data)
View(raw)
summary(raw$GEN)
summary_pics = data_users_muc_at_other %>%
group_by(lkr_id, type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
summary_pics = data_users_muc_at_other %>%
group_by(lkr_id,lkr_name type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
summary_pics = data_users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
ggplot(summary_pics, aes(x=lkr_id, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
summary_pics = data_users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
ggplot(summary_pics, aes(x=lkr_id, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
View(summary_pics)
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
summary_users = users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()/visitors_muc) %>%
filter(type == "visitor")
users_muc_at_other = data_users_muc_at_other %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
summary_users = users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()/visitors_muc) %>%
filter(type == "visitor")
ggplot(summary_users, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
summary_pics = data_users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
users_muc_at_other = data_users_muc_at_other %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
summary_users = users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()/visitors_muc) %>%
filter(type == "visitor")
ggplot(summary_users, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_users, aes(x=as.factor(lkr_id), y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type)
users_muc %>% group_by(type) %>% summarize(count = n())
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type) %>% group_by(personId) %>% summarize(pics = n())
users_muc %>% group_by(type) %>% summarize(count = n())
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type) %>% group_by(personId, type) %>% summarize(pics = n())
users_muc %>% group_by(type) %>% summarize(count = n())
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
data_users_muc_at_other = data %>% filter(personId %in% users_muc$personId, lkr_id != 9162000)
summary_pics = data_users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
raw$time[1]
strptime(raw$time[1])
strptime(raw$time[1], format = "%Y-%m-%d %H:%M:%S.%f")
strptime(now, "%Y-%m-%d %H:%M:%OS")
strptime(Sys.time(), "%Y-%m-%d %H:%M:%OS")
strptime(raw$time[1], format = "%Y-%m-%d")
time1 =raw$time[1]
strptime(time1, format = "%Y-%m-%d")
strptime(Sys.time(), "OS")
strptime(Sys.time(), "%OS")
strptime(Sys.time(), "%S")
strptime(Sys.time(), "0.00")
months(System.time(), abbreviate = F)
months(Sys.time(), abbreviate = F)
months(time1, abbreviate = F)
months(as.time(time1), abbreviate = F)
time1 = Sys.time()
months(as.char(time1), abbreviate = F)
months(as.character(time1), abbreviate = F)
strptime(time1, format = "%Y-%m-%d")
months(time1, abbreviate = F)
time1
strptime(as.date(time1), format = "%Y-%m-%d")
strptime(POSIXt(time1), format = "%Y-%m-%d")
strptime(as.POSIXt(time1), format = "%Y-%m-%d")
library("timeDate", lib.loc="~/R/win-library/3.4")
detach("package:timeDate", unload=TRUE)
miliseconds(time1, abbreviate = F)
months(time1, abbreviate = F)
time1 = as.Date(raw$time[1])
time1 = as.Date(raw$time[1], origin = 0)
time1 = as.Date(raw$time[1], origin = "0")
time1 = as.Date(raw$time[1], origin = "1970-01-01")
strptime(time1, format = "%Y-%m-%d")
months(time1, abbreviate = F)
time1 = as.Date(raw$time[1], origin = "1970-01-01")
months(time1, abbreviate = F)
time1 = as.Date(min(raw$time), origin = "1970-01-01")
months(time1, abbreviate = F)
time1 = as.Date(max(raw$time), origin = "1970-01-01")
time1 = (as.POSIXlt(min(raw$time))
months(time1, abbreviate = F)
data = data %>% rowwise() %>% mutate(lkr_id = if_else(is.na(FA_NR),AGS,FA_NR))
data = data %>% rowwise() %>% mutate(lkr_name = if_else(as.character(FA)=="",as.character(GEN),as.character(FA)))
data = data %>% select(personId, id, time, lon, lat, type, lkr_id, lkr_name)
summary(raw$GEN)
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type) %>% group_by(personId, type) %>% summarize(pics = n())
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
visitors_muc = 432L
unknowk = 342L
data_users_muc_at_other = data %>% filter(personId %in% users_muc$personId, lkr_id != 9162000)
time1 = (as.POSIXlt(min(raw$time)))
time1 = (as.POSIXlt(min(raw$time), origin = "1970-01-01 00:00:00"))
months(time1[1], abbreviate = F)
time1 = (as.POSIXlt((raw$time[1], origin = "1970-01-01 00:00:00"))
months(time1[1], abbreviate = F)
data = data %>% rowwise() %>% mutate(lkr_id = if_else(is.na(FA_NR),AGS,FA_NR))
data = data %>% rowwise() %>% mutate(lkr_name = if_else(as.character(FA)=="",as.character(GEN),as.character(FA)))
data = data %>% select(personId, id, time, lon, lat, type, lkr_id, lkr_name)
summary(raw$GEN)
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type) %>% group_by(personId, type) %>% summarize(pics = n())
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
visitors_muc = 432L
unknowk = 342L
data_users_muc_at_other = data %>% filter(personId %in% users_muc$personId, lkr_id != 9162000)
time1 = (as.POSIXlt((raw$time[1], origin = "1970-01-01 00:00:00")))
time1 = (as.POSIXlt(raw$time[1], origin = "1970-01-01 00:00:00"))
time1 = (as.POSIXlt(raw$time[1]/1000, origin = "1970-01-01 00:00:00"))
time1 = (as.POSIXlt(min(raw$time/1000), origin = "1970-01-01 00:00:00"))
time1 = (as.POSIXlt(max(raw$time/1000), origin = "1970-01-01 00:00:00"))
time1 = (as.POSIXlt(raw$time[100], origin = "1970-01-01 00:00:00"))
time1 = (as.POSIXlt(raw$time[100]/1000, origin = "1970-01-01 00:00:00"))
raw$month = months(as.POSIXlt(raw$time/1000, origin = "1970-01-01 00:00:00")[1], abbreviate = F)
raw %>% group_by(month) %>% summarize(count = n())
raw = raw %>% rowwise() %>%
mutate(month = months(as.POSIXlt(raw$time/1000, origin = "1970-01-01 00:00:00")[1], abbreviate = F))
raw %>% group_by(month) %>% summarize(count = n())
pacman::p_load(dplyr, data.table, ggplot2)
path = "c:/models/flickr/carto/"
file = "allPicsWithLandkreis.csv"
raw = read.csv(paste(path,file,sep=""))
data = raw %>% select(personId, id, time, lon, lat, type, FA, FA_NR, GEN, AGS)
data = raw %>% select(personId, id, time, lon, lat, type, region_id, region_name, month, week)
data = raw %>% select(personId, id, time, lon, lat, type, lkr_id = region_id, lkr_name = region_name, month, week)
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type) %>% group_by(personId, type) %>% summarize(pics = n())
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
users_muc %>% group_by(type, month) %>% summarize(users = n()) %>% tidyr::spread(type, users)
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type, month, week) %>% group_by(personId, type) %>% summarize(pics = n())
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
users_muc %>% group_by(type, month) %>% summarize(users = n()) %>% tidyr::spread(type, users)
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type, month, week) %>% group_by(personId, type, month) %>% summarize(pics = n())
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
users_muc %>% group_by(type, month) %>% summarize(users = n()) %>% tidyr::spread(type, users)
visitors_muc = 432L
unknowk = 342L
data_users_muc_at_other = data %>% filter(personId %in% users_muc$personId, lkr_id != 9162000)
users_muc_at_other = data_users_muc_at_other %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
View(users_muc_at_other)
data_users_muc_at_other = data %>% filter(personId %in% users_muc$personId)
users_muc_at_other = data_users_muc_at_other %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
summary_users = users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()/visitors_muc)
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
summary_pics = data_users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
summary_pics = data_users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()) %>%
filter(type != "unknown")
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
levels = summary_pics$lkr_id[order(summary_pics$n)]
summary_pics$lkr_id = factor(summary_pics$lkr_id, levels = levels)
levels[20]
summary_pics = data_users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n())
summary_pics %>% filter(type == "unknown")
summary_pics %>% group_by(lkr_id,lkr_name) %>% summarize(n = sum(n))
aux = summary_pics %>% group_by(lkr_id,lkr_name) %>% summarize(n = sum(n))
levels = aux$lkr_id[order(aux$n)]
summary_pics$lkr_id = factor(summary_pics$lkr_id, levels = levels)
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
levels = aux$lkr_id[order(aux$n)]
summary_pics$lkr_id = factor(summary_pics$lkr_id, levels = levels)
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_pics, aes(x=lkr_id, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_pics, aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_pics %>% filter(n > 50), aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
users_muc_at_other = data_users_muc_at_other %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
summary_users = users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()/visitors_muc)
ggplot(summary_users, aes(x=as.factor(lkr_id), y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_users, aes(x=as.factor(lkr_id), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
users = nrow(users_muc)
summary_users = users_muc_at_other %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n()/users)
ggplot(summary_users, aes(x=as.factor(lkr_id), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
users_muc_by_zone = data_users_muc %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
summary_users = users_muc_by_zone %>%
group_by(lkr_id,lkr_name) %>%
summarize(n = n()/users)
ggplot(summary_users, aes(x=as.factor(lkr_id), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
users_muc_by_zone = data_users_muc %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
data_users_muc = data %>% filter(personId %in% users_muc$personId)
users_muc_by_zone = data_users_muc %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
summary_users = users_muc_by_zone %>%
group_by(lkr_id,lkr_name) %>%
summarize(n = n()/users)
ggplot(summary_users, aes(x=as.factor(lkr_id), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
users_muc %>% group_by(type, month) %>% summarize(users = n()) %>% tidyr::spread(type, users)
visitors_muc = 432L
unknowk = 342L
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
users = nrow(users_muc)
total = nrow(users_muc)
visitors_muc = nrow(users_muc %>% filter(type == "visitor"))
unknowk = nrow(users_muc %>% filter(type == "unknowk"))
unknowk = nrow(users_muc %>% filter(type == "unknown"))
total = nrow(users_muc)
summary_users = users_muc_by_zone %>%
group_by(lkr_id,lkr_name) %>%
summarize(n = n()/users)
View(summary_users)
summary_users = users_muc_by_zone %>%
group_by(lkr_id,lkr_name) %>%
summarize(n = n())
View(summary_users)
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type) %>% group_by(personId, type) %>% summarize(pics = n())
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
visitors_muc = nrow(users_muc %>% filter(type == "visitor"))
unknowk = nrow(users_muc %>% filter(type == "unknown"))
total = nrow(users_muc)
users_muc_by_zone = data_users_muc %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
summary_users = users_muc_by_zone %>%
group_by(lkr_id,lkr_name) %>%
summarize(n = n())
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
summary_users = users_muc_by_zone %>%
group_by(lkr_id,lkr_name) %>%
summarize(n = n()/total)
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
data = data %>% rowwise() %>% mutate(lkr_name = paste(lkrname, " (", lkr_id,")", sep = ""))
data = data %>% rowwise() %>% mutate(lkr_name = paste(lk_rname, " (", lkr_id,")", sep = ""))
data = data %>% rowwise() %>% mutate(lkr_name = paste(lkr_name, " (", lkr_id,")", sep = ""))
users_muc = data %>% filter(lkr_id == 9162000) %>% select(personId, type) %>% group_by(personId, type) %>% summarize(pics = n())
users_muc %>% group_by(type) %>% summarize(count = n(), pics = sum(pics))
visitors_muc = nrow(users_muc %>% filter(type == "visitor"))
unknowk = nrow(users_muc %>% filter(type == "unknown"))
total = nrow(users_muc)
data_users_muc = data %>% filter(personId %in% users_muc$personId)
summary_pics = data_users_muc %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n())
aux = summary_pics %>% group_by(lkr_id,lkr_name) %>% summarize(n = sum(n))
levels = aux$lkr_id[order(aux$n)]
summary_pics$lkr_id = factor(summary_pics$lkr_id, levels = levels)
ggplot(summary_pics %>% filter(n > 50), aes(x=lkr_name, y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
users_muc_by_zone = data_users_muc %>%
group_by(personId, lkr_id, lkr_name, type) %>%
summarize(pictures = n())
summary_users = users_muc_by_zone %>%
group_by(lkr_id,lkr_name) %>%
summarize(n = n()/total)
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) + ylim(0,0.1)
View(summary_users)
summary_users = users_muc_by_zone %>%
group_by(lkr_id,lkr_name, type) %>%
summarize(n = n())
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) + ylim(0,0.1)
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
total_users_by_type = summary_users %>% group_by(type) %>% summarize(total = sum(n))
View(total_users_by_type)
total_users_by_type = summary_users %>% filter(lkr_id = "9162000") %>% summarize(total = sum(n))
total_users_by_type = summary_users %>% filter(lkr_id == "9162000") %>% summarize(total = sum(n))
View(total_users_by_type)
total_users_by_type = summary_users %>% filter(lkr_id == "9162000") %>% group_by(type) %>% summarize(total = sum(n))
View(total_users_by_type)
summary_users = merge(x=summary_users, y=total_users_by_type, by = "type")
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n/total, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
ggplot(summary_users, aes(x=as.factor(lkr_name), y = n/total, fill = type)) +
geom_bar(stat = "identity", position = "dodge") +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) + ylim(0,0.1)
write.csv(summary_users, file = "c:/models/flickr/gis/usersByLandkreis.csv", row.names = F)
